import{r as S,j as a,a as l}from"./jsx-runtime-f40812bf.js";import{v as N,f as E,L as i,x as C,F as T,a6 as g,k as L,ab as w,ax as D,C as P,ay as I,d as u}from"./Phone-eb89da6c.js";import"./number-28525126.js";function _(){const[d,f]=S.useState(""),[s,m]=S.useState([]),[o,r]=S.useState(null);S.useEffect(()=>{if(N.APPS.NOTES.notes.value)return m(N.APPS.NOTES.notes.value);E("Notes",{action:"fetch"}).then(e=>{m(e),N.APPS.NOTES.notes.set(e)})},[]);const p=e=>{let n=Math.floor(Date.now()),t={title:i("APPS.NOTES.NEW_NOTE"),content:"",timestamp:n,id:null};E("Notes",{action:"create",data:t}).then(c=>{t.id=c,r(t),m([...s,t]),N.APPS.NOTES.notes.set({...s,tempData:t})})},O=e=>{let n=Math.floor(Date.now()),t=[...s],c=t.findIndex(h=>h.id===e.id),v=t[c];if(v.title===e.title&&v.content===e.content){u("info","Note is the same, not saving"),r(null);return}t[c]={...e,timestamp:n},E("Notes",{action:"save",data:t[c]}).then(h=>{if(!h)return u("warning","Failed to save note, server returned false");u("info","Saved note"),r(null),m(t),N.APPS.NOTES.notes.set(t)})},A=e=>{E("Notes",{action:"remove",id:e}).then(n=>{if(!n)return u("warning","Failed to remove note, server returned false");let t=s==null?void 0:s.filter(c=>c.id!==e);r(null),m(t),N.APPS.NOTES.notes.set(t),u("info","Removed note")})};return a("div",{className:"notes-container slide-right",children:o?l("div",{className:"notes-wrapper slide-left",children:[l("div",{className:"top",children:[l("div",{className:"back",onClick:()=>O(o),children:[a("i",{className:"fal fa-chevron-left"}),i("APPS.NOTES.TITLE")]}),a(L,{className:"title",defaultValue:o.title,onChange:e=>{r({...o,title:e.target.value})}}),a("div",{})]}),a(w,{onChange:e=>{r({...o,content:e.target.value})},defaultValue:o.content}),l("div",{className:"notes-bottom",children:[a(D,{onClick:()=>P.PopUp.set({title:i("APPS.NOTES.DELETE_TITLE").format({title:o.title}),description:i("APPS.NOTES.DELETE_TEXT").format({title:o.title}),buttons:[{title:i("APPS.NOTES.BUTTON_CANCEL")},{title:i("APPS.NOTES.BUTTON_DELETE"),color:"red",cb:()=>{A(o.id)}}]})}),a("div",{className:"amount",children:i("APPS.NOTES.LAST_EDITED").format({date:T(o.timestamp)})}),a(I,{onClick:()=>P.Share.set({type:"note",data:o})})]})]}):l("div",{className:"notes-wrapper slide-right",children:[a("div",{className:"title",children:i("APPS.NOTES.TITLE")}),a(C,{placeholder:i("APPS.NOTES.SEARCH_PLACEHOLDER"),onChange:e=>f(e.target.value)}),a("div",{className:"notes-body",children:a("div",{className:"notes-list",children:s==null?void 0:s.filter(e=>{var n,t;return((n=e.title)==null?void 0:n.toLowerCase().includes(d==null?void 0:d.toLowerCase()))||((t=e.content)==null?void 0:t.toLowerCase().includes(d==null?void 0:d.toLowerCase()))}).sort((e,n)=>n.timestamp-e.timestamp).map((e,n)=>l("div",{className:"note-item",onClick:()=>{r(e)},children:[a("div",{className:"note-title",children:e.title}),l("div",{className:"note-details",children:[a("div",{className:"date",children:T(e.timestamp)}),a("div",{className:"content",children:e.content.length>30?e.content.slice(0,30)+"...":e.content})]})]},n))})}),l("div",{className:"notes-bottom",children:[a("div",{}),a("div",{className:"amount",children:i("APPS.NOTES.FOOTER").format({amount:(s==null?void 0:s.length)??0})}),a(g,{onClick:p})]})]})})}export{_ as default};
